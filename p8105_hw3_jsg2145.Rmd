---
title: "p8105_hw3_jsg2145"
author: "Jared Garfinkel"
date: "10/9/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

```{r, cache = TRUE}
library(p8105.datasets)
data("instacart")
```

The "instacart" dataset is `r nrow(instacart)` rows by `r ncol(instacart)` columns. 

There are a few variables that appear to be key to telling us what the dataset is. 

The variable "product_name" is an item that was placed in a cart. Order have an "order_id" number.

Each item in a cart has an "add_to_cart_order", for instance, in the head of the data, "order_id" 1

had 8 items added, 1 through 8 and "add_to_cart_order" gives the order in which the 

items were added.  There are columns that tell the time of day of the order, the days 

since the prior order, and whether a specific item was reordered or not. There are 

also details about where the item is found (aisle, department)

```{r}
aisle_dat <- instacart %>% 
  group_by(aisle) %>%
  summarize(
    count = n()) %>% 
  arrange(desc(count))
```

## Problem 1

There are `r nrow(aisle_dat)` aisles, and `r pull(top_n(aisle_dat, 1, count), aisle)` was the aisle the most items were ordered from.

```{r, fig.width = 10}
instacart %>% 
  group_by(aisle) %>% 
  count() %>% 
  filter(
    n > 10000
  ) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_col() +
  labs(xlab = "Count",
       ylab = "Aisle")

```

```{r}
instacart %>% 
  filter(
    aisle == c("baking ingredients", 
               "dog food care", 
               "packaged vegetables fruits")
    ) %>% 
  mutate(
    aisle = 
      recode(aisle,
             "baking ingredients" = "Baking Ingredients",
             "dog food care" = "Dog Food Care",
             "packaged vegetables fruits" = "Packaged Vegetables Fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarize(
    count =  n()
  ) %>% 
  top_n(., 3, count) %>% 
  arrange(desc(count), .by_group = TRUE) %>% 
  rename(Aisle = aisle,
         "Product Name" = product_name,
         Count = count) %>% 
  knitr::kable()
```

```{r}
instacart %>% 
  filter(product_name == c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(
    mean_hr = round(mean(order_hour_of_day), digits = 1)
  ) %>% 
  mutate(
    order_dow = factor(order_dow, 
                       labels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))) %>%
  rename("Product Name" = product_name) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hr
  ) %>% 
  knitr::kable()
  
  
```

